---
title: "The Watts-Strogatz Model"
output: distill::distill_article
bibliography: bibliography.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(igraph)
```


Many naturally-occurring networks have a distinct and peculiar property.
Although they can be huge in terms of node count, the average path length between two nodes remains small.
**Really** small in some cases.

If you take a social network, for instance, there are some famous experiments that show that any two nodes in the network are usually not separated by more than six degrees (the infamous **six degrees of separation**).

In pop science speak, this means that you are a mere six social connections away from the Queen of England.

The [Erd√∂s-Renyi model](./erdos-renyi-model.html) does not capture this property.

As it had been the predominant random graph model that was used for all kinds of purposes for some time, the field was ready for a new model.

The decisive innovation came from Duncan Watts and Steven Strogatz [@watts1998collective], hence the name **Watts-Strogatz model** (WS model).

Start with a regular ring lattice.

```{r}
g <- make_lattice(c(10, 1), nei = 2, circular = TRUE)
plot(g, vertex.size = 25, vertex.color = "black", vertex.label.color = "white")
```

This is a regular ring lattice.
There are two parameters that you already have to give the WS model to construct this lattice:
$N$ is the number of nodes and $k$ is the mean node degree.

In the case of a regular ring lattice, the mean node degree is assumed to be an even number.
In colloquial terms, you construct it by arranging the nodes in a circle and attaching each node to its $\frac{k}{2}$ neighbors on each side.
That last one is a mouth full.
Let's look at it in detail.

Consider the graph above again and look at node 1.
It attaches to $2$ and $3$ on one side and to $10$ and $9$ on the other.
Node $2$ attaches to $3$ and $4$ on the one side and to $1$ and $10$ on the other.
You can check this for every node and see that they all attach to $2$ other nodes on each side.
Hence the parameter $k$, in this case, is $4$.

Here is an example with $k = 6$:

```{r}
g <- make_lattice(c(10, 1), nei = 3, circular = TRUE)
plot(g, vertex.size = 25, vertex.color = "black", vertex.label.color = "white", layout = layout_in_circle(g))
```

And for good measure, here is a lattice with $k = 2$:

```{r}
g <- make_lattice(c(10, 1), nei = 1, circular = TRUE)
plot(g, vertex.size = 25, vertex.color = "black", vertex.label.color = "white", layout = layout_in_circle(g))
```


Let's return to the first graph:

```{r}
g <- make_lattice(c(10, 1), nei = 2, circular = TRUE)
plot(g, vertex.size = 25, vertex.color = "black", vertex.label.color = "white", layout = layout_in_circle(g))
```

Suppose the above graph is the regular ring lattice you constructed.
The WS model algorithm now proceeds as follows:

First, there is yet another parameter that we need, $\beta$.
Start with node 1 now and go through each edge that attaches to it.
Reroute each edge to another node with probability $\beta$.
The node to reroute to is drawn uniformly at random while avoiding self-loops.
This means that you put all the other nodes (*excluding* the node in question, in this case node 1) in a bag and just draw a new node to attach the edge to.

Here are some samples that were generated by this model:

$\beta = 0.3$:

```{r}
g <- sample_smallworld(1, 10, 2, 0.3, loops = FALSE, multiple = FALSE)
plot(g, vertex.size = 25, vertex.color = "black", vertex.label.color = "white", layout = layout_in_circle(g))
```

$\beta = 0.1$

```{r}
g <- sample_smallworld(1, 10, 2, 0.1, loops = FALSE, multiple = FALSE)
plot(g, vertex.size = 25, vertex.color = "black", vertex.label.color = "white", layout = layout_in_circle(g))
```

$\beta = 0.9$

```{r}
g <- sample_smallworld(1, 10, 2, 0.9, loops = FALSE, multiple = FALSE)
plot(g, vertex.size = 25, vertex.color = "black", vertex.label.color = "white", layout = layout_in_circle(g))
```


#### Task

Can you guess what happens if you set $\beta = 1$?

#### Task

Implement this model in [Julia](https://julialang.org/). (TODO: write basic julia or Graphs.jl tutorial)

